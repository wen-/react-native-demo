<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>加解密</title>
	<script src="node_modules/jquery/dist/jquery.min.js"></script>
	<script src="node_modules/crypto-js/crypto-js.js"></script>
	<style type="text/css">
		.ub-con,.ub-fh{width:100%}blockquote,body,button,dd,dl,dt,fieldset,form,h1,h2,h3,h4,h5,h6,hr,input,legend,li,ol,p,pre,td,textarea,th,ul{margin:0;padding:0;font-size:100%;vertical-align:baseline}table{border-collapse:collapse;border-spacing:0}ol,ul{list-style:none}a{text-decoration:none}a:hover{text-decoration:underline}sup{vertical-align:text-top}sub{vertical-align:text-bottom}legend{color:#000}fieldset,img{border:0}button,h1,h2,h3,h4,h5,h6,input,select,textarea{font-size:100%}input,textarea{outline:0;background:#fff}article,aside,audio,details,figcaption,figure,footer,header,hgroup,mark,menu,nav,section,summary,time,video{display:block;margin:0;padding:0}mark{background:#ff0}.ub-img,.ub-img1{background-repeat:no-repeat;background-position:center}audio,canvas,video{display:inline-block}audio:not([controls]){display:none}address,cite,dfn,em,i,var{font-style:normal}code,kbd,pre,samp{font-family:courier new,courier,monospace}small{font-size:12px}hr{height:.4em;background-color:#eee;border:none}.ub-con,.ub-fv{height:100%}.lfloat{float:left;display:inline}.rfloat{float:right;display:inline}.pr{position:relative}.pa{position:absolute}.inlineb{display:inline-block!important;vertical-align:middle}.clearfix:after,.clearfix:before{content:"";display:table}.clearfix:after{clear:both;overflow:hidden}.clearfix{zoom:1}.clear{clear:both}.tr{text-align:right!important}.tl{text-align:left!important}.tc{text-align:center!important}.tj{text-align:justify!important}.vt{vertical-align:top!important}.vm{vertical-align:middle!important}.vb{vertical-align:bottom!important}.ub{display:-webkit-box!important;display:box!important;position:relative}.ub-rev{-webkit-box-direction:reverse;box-direction:reverse}.ub-con{position:absolute}.ub-f1,.ub-f2,.ub-f3,.ub-f4{position:relative}.ub-ac{-webkit-box-align:center;box-align:center}.ub-ae{-webkit-box-align:end;box-align:end}.ub-pc{-webkit-box-pack:center;box-pack:center}.ub-pe{-webkit-box-pack:end;box-pack:end}.ub-pj{-webkit-box-pack:justify;box-pack:justify}.ub-ver{-webkit-box-orient:vertical;box-orient:vertical}.ub-f1{-webkit-box-flex:1;box-flex:1}.ub-f2{-webkit-box-flex:2;box-flex:2}.ub-f3{-webkit-box-flex:3;box-flex:3}.ub-f4{-webkit-box-flex:4;box-flex:4}.ub-img{background-size:contain}.ub-img1{background-size:cover}.ub-img2{background-repeat:repeat-x;background-size:auto 100%}.ub-img3,.ub-img4{background-size:100% auto}.ub-img3{background-repeat:repeat-y}.ub-img4,.ub-img5,.ub-img6,.ub-img7{background-repeat:no-repeat;background-position:center}.ub-img5{background-size:auto 100%}.ub-img7{background-size:100% 100%}input:-webkit-autofill,select:-webkit-autofill,textarea:-webkit-autofill{background:0 0!important}input{-webkit-appearance:none;-webkit-tap-highlight-color:#fff}@media all{html{font-size:16px}}@media all and (min-width:140px) and (min-height:220px){html{font-size:9px}}@media all and (min-width:220px) and (min-height:140px){html{font-size:9px}}@media all and (min-width:210px) and (min-height:280px),(min-width:280px) and (min-height:210px),(min-width:280px) and (min-height:280px){html{font-size:14px}}@media all and (min-width:300px) and (min-height:460px),(min-width:460px) and (min-height:300px){html{font-size:16px}}@media all and (min-width:340px) and (min-height:620px),(min-width:620px) and (min-height:340px){html{font-size:20px}}@media all and (min-width:420px) and (min-height:760px) and (max-height:900px),(min-width:760px) and (max-width:900px) and (min-height:420px){html{font-size:24px}}@media all and (min-width:1000px) and (min-height:740px),(min-width:740px) and (min-height:1000px){html{font-size:20px}}@media all and (min-width:1200px) and (min-height:600px),(min-width:600px) and (min-height:1200px){html{font-size:16px}}@media all and (device-width:1024px) ,(device-width:768px){html{font-size:20px}}@media all and (device-width:960px) and (device-height:640px),(device-width:640px) and (device-height:960px){html{font-size:32px}}@media all and (device-width:480px) and (min-device-height:800px) and (max-device-height:900px),(min-device-width:800px) and (max-device-width:900px) and (device-height:480px){html{font-size:24px}}@media all and (device-width:360px) and (device-height:640px),(device-width:640px) and (device-height:360px){html{font-size:20px}}@media all and (device-width:320px) and (device-height:480px),(device-width:480px) and (device-height:320px){html{font-size:16px}}@media all and (device-width:240px) and (device-height:320px),(device-width:320px) and (device-height:240px),(device-width:320px) and (device-height:320px){html{font-size:14px}}
		.crypto{
			padding:1em;
		}
		label{
			display: block;
			width:8em;
			text-align: right;
		}
		input,textarea{
			border:solid 1px #ccc;
			padding:5px;
		}
		.crypto li{
			list-style: none;
			margin-bottom: 1em;
		}
		.crypto input,
		.crypto textarea{
			display: block;
		}
		.crypto textarea{
			min-height: 10em;
		}
		button.btn{
			border: solid 1px #0b7218;
			padding: 5px 2em;
			background-color: #198b0b;
			color: #fff;
			border-radius: 6px;
			box-shadow: 0px 1px 5px #333;
			cursor: pointer;
		}
		.crypto_txt{
			word-break: break-all;
		}

	</style>
</head>
<body>
	<ul class="crypto">
		<li class="ub">
			<label>请输入密钥：</label>
			<input class="key ub-f1" type="text" />
		</li>
		<li class="ub">
			<label>请输入加密内容：</label>
			<textarea class="txt ub-f1"></textarea>
		</li>
		<li class="ub">
			<label></label>
			<div>
				<button type="button" class="btn crypto_btn">加密</button>
			</div>
		</li>

		<li class="ub">
			<label>加密结果：</label>
			<div class="crypto_txt ub-f1"></div>
		</li>
		<li class="ub">
			<label></label>
			<div class="crypto_txt_copy">
				<button type="button" class="btn copy_btn">复制</button>
			</div>
		</li>
	</ul>
<script>
	$(function () {
		$(".crypto_btn").on("click",function(){
			let _key = $(".key").val();
			let _txt = $.trim($(".txt").val());
			if(_key.length == 16 || _key.length == 24 || _key.length == 32){
				if(!_txt){
					alert("加密内容不能为空");
					return false;
				}
				let _v = _key.substring(0,16);
				let _k = CryptoJS.enc.Utf8.parse(_key);
				_v = CryptoJS.enc.Utf8.parse(_v);
				let _c = CryptoJS.AES.encrypt(_txt, _k,{"iv":_v,"mode": CryptoJS.mode.CBC,"padding":CryptoJS.pad.Pkcs7});
				_c = _c.toString();
				console.log(_c);
				$(".crypto_txt").text(_c);
			}else{
				alert("密钥长度为16/24/32位");
				return false;
			}
		});


		let test = CryptoJS.AES.encrypt("ABCD","123456789");
		let ec = test.toString();
		console.log("ABCD加密后为："+ec);

		let newtest = CryptoJS.AES.decrypt(ec,"123456789");
		console.log(ec+"解密后为："+newtest.toString(CryptoJS.enc.Utf8));


//		使用AES加密前，先了解下WordArray，我把它理解成CryptoJS中定义的 新的 数据类型，叫“单词数组”。
//
//      2.1 ： 初始化
//		var wordArray = CryptoJS.lib.WordArray.create();//创建一个空的 WordArray对象

//		2.2 ： WordArray 对象 —>16进制字符串
//		var string = wordArray.toString();//默认CryptoJS.enc.Hex，即16进制字符串
//		var string = wordArray.toString(CryptoJS.enc.Utf8);//utf-8字符串

//		2.3 ： 16进制字符串 —>WordArray对象
//		var wordArray = CryptoJS.enc.Hex.parse(hexString);

//		2.4 ： WordArray对象—>utf8字符串
//		var utf8String = CryptoJS.enc.Utf8.stringify(wordArray);
//      //等价于2.2中 wordArray.toString(CryptoJS.enc.Utf8);

//		2.5 ： utf8字符串—>WordArray对象
//		var wordArray = CryptoJS.enc.Utf8.parse(utf8String);

//		2.6 ： WordArray对象—>Base64字符串
//		var base64String = CryptoJS.enc.Base64.stringify(wordArray);

//		2.7 ： Base64字符串—>WordArray对象
//		var wordArray = CryptoJS.enc.Base64.parse(base64String);

		/*加密KEY*/
		// 密钥key长度必须为16（AES-128）、24（AES-192）、或32（AES-256）Bytes 长度
		let key = "FO1KQXmtxhlA6PKF";
		let iv = "XZqkPmDBA6m0SjBP";
		key = CryptoJS.enc.Utf8.parse(key);
		iv = CryptoJS.enc.Utf8.parse(iv);

		//let k = "JVZ+RWZ8JlQz5KW4ULrjfefdHoJOTukKGF+IAcZeNU0=";//{"mobile":"13533051889"}
		let k = "KKK+6F19ZoJpP+d6t1VXYfmAD/xifPcOY1yYIYeP+NTULYXfb+dHLMhKT/VhDl18z6i8QbqqAQKhlgS5FEoj/Vx0Hz8hLuDizaMI9dFvDaVegQV15BQox+tUkp37Yz5fYFNNPCfjuNQqU8QxFze4kIIo8FmhU9vbE1dzBXCMlvYFKyuhVVyziz3mlV8F0pwvO6uhY0wauYEgiNPrfOZrlq/O7j0VHd70HWXO2Ejs2IBL2gVZ494tes251N6N5+DsAS5FtgW72r6E9HZhcNczLZyoUOMYHC1Pa7sMnpyY11WAdYlgVUZklwCEzydESAMcRjBJWoK07DOC3uOzyiUzxZ0LdqZ6wAb/Zsl0E9MJ2QGquX4aLKFBbQ9o3NpCNLd2hq9+rwjOPHvXoiGI2KPWN07B3iKCSJdi0vur2iaU0MzAJH5X58Drj196ITT3m8csFEPOrB3/AJz6MpqAfn1ygEsblEYx7utKsjzKPjLREtwujI0AjlJNWtktjzW8gSQnCEFsHV7+tRQUStHsorPxfpT7axkHWSAMNFibBD+lWG2pqv3PiiOhVY+MtM8fetqd";
		let dk = CryptoJS.AES.decrypt(k,key,{"iv":key,"mode": CryptoJS.mode.CBC,"padding":CryptoJS.pad.Pkcs7});
		console.log(dk.toString(CryptoJS.enc.Utf8));

		let data = {"mobile":"13533051889"};
		let ciphertext = CryptoJS.AES.encrypt(JSON.stringify(data), key,{"iv":iv,"mode": CryptoJS.mode.CBC,"padding":CryptoJS.pad.Pkcs7});
		console.log(ciphertext.toString());
	});
</script>
</body>
</html>